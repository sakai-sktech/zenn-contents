---
title: "Dockerã‚’Ubuntuç’°å¢ƒã«ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹"
emoji: "ðŸ“—"
type: "tech"
topics: ["docker", "ubuntu"]
published: true
---

# Dockerã‚’Ubuntuç’°å¢ƒã«ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

## ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«å‰ã®æº–å‚™

è‡ªåˆ†ã«ã¨ã£ã¦ã€Œç°¡æ½”ã§åˆ†ã‹ã‚Šã‚„ã™ã‹ã£ãŸã€ã®ã¯ã“ã“ã€‚

https://www.digitalocean.com/community/tutorials/how-to-install-and-use-docker-on-ubuntu-20-04-ja

Ubuntu20.04ã®å ´åˆã€ä¸Šè¨˜ã‚µã‚¤ãƒˆ[Ubuntu20.04ã¸ã®Dockerã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«åŠã³ä½¿ç”¨æ–¹æ³•](https://www.digitalocean.com/community/tutorials/how-to-install-and-use-docker-on-ubuntu-20-04-ja)ã«ã‚ã‚‹ã¨ãŠã‚Šã§ã€ä»¥ä¸‹ã®ã‚³ãƒžãƒ³ãƒ‰ã‚’é †ã«å®Ÿè¡Œã™ã‚Œã°OKã€‚

[ä¸Šè¨˜ã‚µã‚¤ãƒˆ](https://www.digitalocean.com/community/tutorials/how-to-install-and-use-docker-on-ubuntu-20-04-ja)ä¸­ã®ã‚³ãƒžãƒ³ãƒ‰ä¾‹ã§ã€Ubuntu20.04ä»¥å¤–ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã§ã‚‚åˆ©ç”¨ã§ãã‚‹ã‚ˆã†ã«add-apt-repositoryã®"focal"ã®éƒ¨åˆ†ã‚’`$(lsb_release -cs)`ã«å¤‰æ›´ã—ã¦ã„ã¾ã™ã€‚

```Shell:ãƒªãƒã‚¸ãƒˆãƒªã¸ã®ç™»éŒ²
sudo apt update
sudo apt install apt-transport-https ca-certificates curl software-properties-common -y
curl -fsSL https://download.docker.com/linux/ubuntu/gpg | sudo apt-key add -
sudo add-apt-repository "deb [arch=amd64] https://download.docker.com/linux/ubuntu $(lsb_release -cs) stable"
sudo apt update
```

æ‰‹å…ƒã®Ubuntu18.04(bionic)ã§å®Ÿè¡Œã—ã¦ã¿ãŸçµæžœã€‚ã€Œå–å¾—ï¼šã€ã®è¡Œã«bionicãŒã‚ã‚‹ã®ãŒç¢ºèªå‡ºæ¥ã¾ã™ã€‚

```Shell:å®Ÿè¡Œçµæžœ
sudo add-apt-repository "deb [arch=amd64] https://download.docker.com/linux/ubuntu $(lsb_release -cs) stable"
#...ï¼ˆé€”ä¸­ç•¥ï¼‰
å–å¾—:8 https://download.docker.com/linux/ubuntu bionic InRelease [64.4 kB] 
#...ï¼ˆä»¥ä¸‹ç•¥ï¼‰
```

ã“ã“ã¾ã§å®Ÿè¡Œã—ãŸçµæžœã€ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã§åˆ©ç”¨ã™ã‚‹ãƒªãƒã‚¸ãƒˆãƒªãŒUbuntuã§ã¯ãªãã€Dockerãƒªãƒã‚¸ãƒˆãƒªã‹ã‚‰ã®ã‚‚ã®ã«ãªã£ã¦ã„ã‚‹ã‹ã¯ä¸‹è¨˜ã§ç¢ºèªã§ãã¾ã™ã€‚ä¸‹è¨˜ã§Ubuntu18.04ã®å®Ÿè¡Œä¾‹ã¯ã€ã¾ã ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¦ã„ãªã„ç’°å¢ƒã§ã®å®Ÿè¡Œçµæžœãªã®ã§ã€ã€Œã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã¦ã„ã‚‹ãƒãƒ¼ã‚¸ãƒ§ãƒ³ï¼š(ãªã—)ã€ã«ãªã£ã¦ã„ã¾ã™ã€‚

```Shell:ãƒªãƒã‚¸ãƒˆãƒªã®ç¢ºèª
#Ubuntu20.04(docker-ceã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«æ¸ˆã¿)ã®å ´åˆ
apt-cache policy docker-ce
docker-ce:
  ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã¦ã„ã‚‹ãƒãƒ¼ã‚¸ãƒ§ãƒ³: 5:20.10.10~3-0~ubuntu-focal
  å€™è£œ:               5:20.10.10~3-0~ubuntu-focal
  ãƒãƒ¼ã‚¸ãƒ§ãƒ³ãƒ†ãƒ¼ãƒ–ãƒ«:
 *** 5:20.10.10~3-0~ubuntu-focal 500
        500 https://download.docker.com/linux/ubuntu focal/stable amd64 Packages
        100 /var/lib/dpkg/status
...ï¼ˆä»¥ä¸‹ç•¥ï¼‰

#Ubuntu18.04(docker-ceæœªã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«)ã®å ´åˆ
apt-cache policy docker-ce
docker-ce:
  ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã¦ã„ã‚‹ãƒãƒ¼ã‚¸ãƒ§ãƒ³: (ãªã—)
  å€™è£œ:               5:20.10.10~3-0~ubuntu-bionic
  ãƒãƒ¼ã‚¸ãƒ§ãƒ³ãƒ†ãƒ¼ãƒ–ãƒ«:
     5:20.10.10~3-0~ubuntu-bionic 500
        500 https://download.docker.com/linux/ubuntu bionic/stable amd64 Packages
...ï¼ˆä»¥ä¸‹ç•¥ï¼‰
```

## ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«å®Ÿè¡Œ

ã“ã“ã¾ã§ã§ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«æº–å‚™ã¯çµ‚ã‚ã£ã¦ã„ã‚‹ã®ã§ã€ä»–ã®ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸åŒæ§˜ä»¥ä¸‹ã®ã‚³ãƒžãƒ³ãƒ‰ã§ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«å‡ºæ¥ã¾ã™ã€‚

```Shell:ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«å®Ÿè¡Œ
sudo apt install docker-ce
```

ã“ã‚Œã§ã€Dockerã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã€ãƒ‡ãƒ¼ãƒ¢ãƒ³èµ·å‹•ã€ãƒ–ãƒ¼ãƒˆæ™‚ã®èµ·å‹•ç™»éŒ²ãŒå®Œäº†ã—ã¦ã„ã¾ã™ã€‚ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã®ç¢ºèªã¯ä¸‹è¨˜ã‚³ãƒžãƒ³ãƒ‰ã§å‡ºæ¥ã¾ã™ã€‚

```Shell:dockerã‚µãƒ¼ãƒ“ã‚¹ã®ç¢ºèª
sudo systemctl status docker
â— docker.service - Docker Application Container Engine
     Loaded: loaded (/lib/systemd/system/docker.service; enabled; vendor preset: enabled)
     Active: active (running) since Tue 2021-10-26 18:09:11 JST; 16h ago
TriggeredBy: â— docker.socket
       Docs: https://docs.docker.com
   Main PID: 13808 (dockerd)
      Tasks: 26
     Memory: 485.1M
     CGroup: /system.slice/docker.service
             â”œâ”€13808 /usr/bin/dockerd -H fd:// --containerd=/run/containerd/containerd.sock
             â”œâ”€15820 /usr/bin/docker-proxy -proto tcp -host-ip 0.0.0.0 -host-port 8080 -container-ip 172.17.0.2 -container-port 80
             â””â”€15828 /usr/bin/docker-proxy -proto tcp -host-ip :: -host-port 8080 -container-ip 172.17.0.2 -container-port 80
# ...ï¼ˆä»¥ä¸‹ç•¥ï¼‰
```

Active: active (running)ã«ãªã£ã¦ã„ã‚Œã°ç„¡äº‹ã«Dockerã‚µãƒ¼ãƒ“ã‚¹ãŒèµ·å‹•å‡ºæ¥ã¦ã„ã¾ã™ã€‚
ä»¥ä¸Šã§docker-ceã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ä½œæ¥­ã¯å®Œäº†ã§ã™ã€‚

:::message
ä¸Šè¨˜å®Ÿè¡Œä¾‹ã¯ã€æ‰‹å…ƒã®Ubuntu20.04ã§æ—¢ã«Dockerã‚³ãƒ³ãƒ†ãƒŠ(nginx)ã‚’å®Ÿè¡Œã—ã¦ã„ã‚‹ç’°å¢ƒã§ã®å®Ÿè¡Œä¾‹ãªã®ã§ã€CGroupã«è¤‡æ•°ã®ãƒ—ãƒ­ã‚»ã‚¹ãŒã¶ã‚‰ä¸‹ãŒã£ã¦ã„ã¾ã™ã€‚æ–°è¦ã«ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ãŸç›´å¾Œã¯ä¸‹ã®ã‚ˆã†ã«ã€1è¡Œã ã‘è¡¨ç¤ºã•ã‚Œã‚‹ã¯ãšã§ã™ã€‚
:::

```Shell:docker-ceã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ç›´å¾Œã®CGroupéƒ¨åˆ†
CGroup: /system.slice/docker.service
             â””â”€13808 /usr/bin/dockerd -H fd:// --containerd=/run/containerd/containerd.sock
```

:::message
ã“ã®CGroupã§è¡¨ç¤ºã•ã‚Œã‚‹ãƒ—ãƒ­ã‚»ã‚¹ã¯`sudo systemd-cgls`ã§ç¢ºèªã§ãã‚‹ã€systemdç®¡ç†ä¸‹ã®cgroupsã¨åŒã˜ã‚‚ã®ã§ã™ã€‚ä¸‹ã®å®Ÿè¡Œä¾‹ã§ã¯ã€æ—¢ã«Dockerã®ã‚³ãƒ³ãƒ†ãƒŠã§nginxã‚’ç¨¼åƒã•ã›ã¦ã„ã‚‹ã®ã§ã€docker.serviceã«ã¶ã‚‰ä¸‹ãŒã£ã¦ã„ã‚‹3ã¤ã®ãƒ—ãƒ­ã‚»ã‚¹ï¼ˆsystemctl status dockerã®CGroupã¨åŒã˜ã‚‚ã®ï¼‰ä»¥å¤–ã«ã€containerd.serviceã«nginxã®ãƒ—ãƒ­ã‚»ã‚¹ãŒã¶ã‚‰ä¸‹ãŒã£ã¦ã„ã‚‹ã“ã¨ãŒç¢ºèªå‡ºæ¥ã¾ã™ã€‚
:::
```shell:systemd-cgls
sudo systemd-cgls
-.slice
â”œâ”€user.slice 
â”‚...ï¼ˆé€”ä¸­ç•¥ï¼‰
â”‚ 
â””â”€system.slice 
  â”œ...ï¼ˆé€”ä¸­ç•¥ï¼‰ 
  â”œâ”€containerd.service â€¦
  â”‚ â”œâ”€ 4193 /usr/bin/containerd
  â”‚ â”œâ”€15843 /usr/bin/containerd-shim-runc-v2 -namespace moby -id 5c520d0ccd2f9289ec1bbc8bd0c>
  â”‚ â”œâ”€15864 nginx: master process nginx -g daemon off;
  â”‚ â”œâ”€15908 nginx: worker process
  â”‚ â”œâ”€15909 nginx: worker process
  â”‚ â”œâ”€15910 nginx: worker process
  â”‚ â””â”€15911 nginx: worker process
  â”‚ ...ï¼ˆé€”ä¸­ç•¥ï¼‰
  â”œâ”€docker.service â€¦
  â”‚ â”œâ”€13808 /usr/bin/dockerd -H fd:// --containerd=/run/containerd/containerd.sock
  â”‚ â”œâ”€15820 /usr/bin/docker-proxy -proto tcp -host-ip 0.0.0.0 -host-port 8080 -container-ip >
  â”‚ â””â”€15828 /usr/bin/docker-proxy -proto tcp -host-ip :: -host-port 8080 -container-ip 172.1>
...ï¼ˆä»¥ä¸‹ç•¥ï¼‰
```









